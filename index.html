<div id="newsList"></div>

<script type="module">
import { db } from "./firebase.js";
import { collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const newsList = document.getElementById("newsList");

async function loadNews() {
  newsList.innerHTML = '';
  const q = query(collection(db, "news"), orderBy("createdAt","desc"));
  const snapshot = await getDocs(q);

  let count = 0;
  let inlineBannerCount = 0;

  snapshot.forEach(docSnap => {
    const data = docSnap.data();
    const div = document.createElement("div");
    div.classList.add("news-item");

    // News content
    div.innerHTML = `<h3>${data.title}</h3><p>${data.content}</p>`;

    // Popunder button after each news item
    const popBtn = document.createElement("button");
    popBtn.textContent = "Click here to view full news";
    popBtn.style.marginTop = "10px";
    popBtn.style.padding = "8px 15px";
    popBtn.style.background = "#007bff";
    popBtn.style.color = "#fff";
    popBtn.style.border = "none";
    popBtn.style.borderRadius = "5px";
    popBtn.style.cursor = "pointer";

    popBtn.addEventListener("click", function() {
        window.open(
            "https://your-popunder-ad-url.com", // Replace with your popunder URL
            "_blank",
            "width=1,height=1,scrollbars=no,menubar=no,status=no,toolbar=no"
        );
    });

    div.appendChild(popBtn);

    newsList.appendChild(div);
    count++;

    // Insert inline banner every 5 news items
    if(count % 5 === 0) {
      inlineBannerCount++;
      const bannerDiv = document.createElement('div');
      bannerDiv.classList.add('inline-banner');
      bannerDiv.id = 'inline-banner-' + inlineBannerCount;
      newsList.appendChild(bannerDiv);

      // Load banner for this container
      loadBanner('inline-banner-' + inlineBannerCount);
    }
  });
}

loadNews();
</script>

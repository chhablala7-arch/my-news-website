<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Latest News</title>

<style>
body{font-family:Arial;background:#f5f5f5;margin:0;padding:15px}
h1{text-align:center}

.news-item{
  background:#fff;
  padding:15px;
  margin:15px auto;
  max-width:600px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.1)
}
.news-item img{
  width:100%;
  max-height:220px;
  object-fit:cover;
  border-radius:6px;
  margin-bottom:10px
}
.news-title{
  font-size:18px;
  font-weight:bold;
  margin-bottom:8px;
  pointer-events:auto;
  position:relative;
  z-index:10;
}
.news-text{font-size:14px;color:#333}

.read-btn{
  margin-top:12px;
  width:100%;
  padding:10px;
  background:#1a73e8;
  color:#fff;
  border:none;
  border-radius:6px;
  font-size:15px;
  cursor:pointer
}

#ad-top,.inline-ad,#native-ad{
  text-align:center;
  margin:20px 0
}

/* Mobile native only */
@media(min-width:768px){
  #native-ad{display:none}
}
</style>

<!-- ✅ Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4DDF4YYZ9K"></script>
<script>
window.dataLayer=window.dataLayer||[];
function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());
gtag('config','G-4DDF4YYZ9K');
</script>

</head>
<body>

<h1>Latest News</h1>

<!-- ✅ TOP BANNER -->
<div id="ad-top"></div>
<script>
window.atOptions={
  'key':'156a5ae4a4cc8e1506a2cc3b96c9b641',
  'format':'iframe',
  'height':250,
  'width':300,
  'params':{}
};
</script>
<script src="https://www.highperformanceformat.com/156a5ae4a4cc8e1506a2cc3b96c9b641/invoke.js"></script>

<!-- ✅ Native Ad (Mobile) -->
<div id="native-ad"></div>
<script async data-cfasync="false"
src="https://pl28637177.effectivegatecpm.com/fad14f1164a018aa8db8e8eb354764ac/invoke.js">
</script>

<div id="newsList"></div>

<script type="module">
import { db } from "./firebase.js";
import { collection,getDocs,query,orderBy }
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const newsList=document.getElementById("newsList");

let popUsed=false; // 1 pop per session

async function loadNews(){
  const q=query(collection(db,"news"),orderBy("createdAt","desc"));
  const snap=await getDocs(q);
  let count=0;

  snap.forEach(doc=>{
    const d=doc.data();
    const box=document.createElement("div");
    box.className="news-item";
    box.innerHTML=`
      ${d.image?`<img src="${d.image}">`:""}
      <div class="news-title">${d.title}</div>
      <div class="news-text">${d.content.substring(0,120)}...</div>
    `;

    const btn=document.createElement("button");
    btn.className="read-btn";
    btn.innerText="पूरी खबर पढ़ें";

    btn.onclick=()=>{
      if(!popUsed){
        window.open("https://YOUR-POPUNDER-URL","_blank");
        popUsed=true;
      }
      window.location.href=`news.html?id=${doc.id}`;
    };

    box.appendChild(btn);
    newsList.appendChild(box);
    count++;

    // Inline banner every 4 news
    if(count%4===0){
      const ad=document.createElement("div");
      ad.className="inline-ad";
      ad.innerHTML=`<script src="https://www.highperformanceformat.com/156a5ae4a4cc8e1506a2cc3b96c9b641/invoke.js"><\/script>`;
      newsList.appendChild(ad);
    }
  });
}

loadNews();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>News Home</title>

<style>
body { font-family: Arial; background: #f9f9f9; margin: 0; padding: 20px; }
h1 { text-align: center; color: #333; }
.news-item { background: white; padding: 15px; margin: 15px auto; border-radius: 8px; max-width: 600px; box-shadow: 0 0 10px rgba(0,0,0,0.1);}
.news-item h3 { margin: 0 0 10px 0; }
.news-item p { margin: 0; }
#adminLogin { display: block; text-align: center; margin: 20px; font-size: 18px; text-decoration: none; color: #007bff; }
#adminLogin:hover { text-decoration: underline; }
#ad-banner, .inline-banner, #extra-ad { text-align: center; margin: 20px 0; }
#native-ad { max-width: 600px; margin: 20px auto; overflow: hidden; }
#native-ad img { max-height: 180px; object-fit: cover; }

/* Mobile-only Native */
@media (min-width: 768px) {
  #native-ad { display: none; }
}
</style>
</head>

<body>

<h1>Latest News</h1>

<!-- Mobile-only Native Ad -->
<div id="native-ad"></div>
<script async data-cfasync="false"
src="https://pl28637177.effectivegatecpm.com/fad14f1164a018aa8db8e8eb354764ac/invoke.js">
</script>

<!-- Top Banner Ad -->
<div id="ad-banner"></div>
<script>
let bannerLoaded = false;

function loadBanner(containerId) {
  const s = document.createElement('script');
  s.src = 'https://www.highperformanceformat.com/156a5ae4a4cc8e1506a2cc3b96c9b641/invoke.js';
  s.async = true;
  document.getElementById(containerId).appendChild(s);
}

window.atOptions = {
  'key' : '156a5ae4a4cc8e1506a2cc3b96c9b641',
  'format' : 'iframe',
  'height' : 250,
  'width' : 300,
  'params' : {}
};

// Load top banner
loadBanner('ad-banner');
bannerLoaded = true;
</script>

<!-- Extra Ad Script -->
<div id="extra-ad"></div>
<script>
const extraAdScript = document.createElement('script');
extraAdScript.src = 'https://pl28638101.effectivegatecpm.com/86/dc/61/86dc615d03616505d0012f407e25655d.js';
extraAdScript.async = true;
document.getElementById('extra-ad').appendChild(extraAdScript);
</script>

<!-- News List -->
<div id="newsList"></div>

<a href="login.html" id="adminLogin">Admin Login</a>

<script type="module">
import { db } from "./firebase.js";
import { collection, getDocs, query, orderBy } from 
"https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const newsList = document.getElementById("newsList");

async function loadNews() {
  newsList.innerHTML = '';
  const q = query(collection(db, "news"), orderBy("createdAt","desc"));
  const snapshot = await getDocs(q);

  let count = 0;
  let inlineBannerCount = 0;

  snapshot.forEach(docSnap => {
    const data = docSnap.data();
    const div = document.createElement("div");
    div.classList.add("news-item");
    div.innerHTML = `<h3>${data.title}</h3><p>${data.content}</p>`;
    newsList.appendChild(div);
    count++;

    // Insert inline banner every 5 news items
    if(count % 5 === 0) {
      inlineBannerCount++;
      const bannerDiv = document.createElement('div');
      bannerDiv.classList.add('inline-banner');
      bannerDiv.id = 'inline-banner-' + inlineBannerCount;
      newsList.appendChild(bannerDiv);

      // Load banner for this container
      loadBanner('inline-banner-' + inlineBannerCount);
    }
  });
}

loadNews();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>News</title>

<!-- ✅ Open Graph (Social Share) -->
<meta property="og:type" content="article">
<meta property="og:title" content="">
<meta property="og:description" content="">
<meta property="og:image" content="">
<meta property="og:url" content="">

<style>
body{
  font-family:Arial;
  background:#f5f5f5;
  margin:0;
  padding:15px
}
.container{
  max-width:700px;
  margin:auto;
  background:#fff;
  padding:16px;
  border-radius:8px;
  box-shadow:0 2px 6px rgba(0,0,0,.1)
}
h1{
  font-size:22px;
  margin-bottom:10px
}
img{
  width:100%;
  max-height:320px;
  object-fit:cover;
  border-radius:6px;
  margin-bottom:12px
}
.meta{
  font-size:13px;
  color:#666;
  margin-bottom:15px
}
.content{
  font-size:16px;
  line-height:1.7;
  color:#222
}
#ad-top,.ad-inline{
  text-align:center;
  margin:20px 0
}
</style>

<!-- ✅ Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4DDF4YYZ9K"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-4DDF4YYZ9K');
</script>

</head>
<body>

<!-- ✅ TOP BANNER AD -->
<div id="ad-top">
<script>
window.atOptions={
  'key':'156a5ae4a4cc8e1506a2cc3b96c9b641',
  'format':'iframe',
  'height':250,
  'width':300,
  'params':{}
};
</script>
<script src="https://www.highperformanceformat.com/156a5ae4a4cc8e1506a2cc3b96c9b641/invoke.js"></script>
</div>

<div class="container" id="newsBox">
  Loading news...
</div>

<!-- ✅ INLINE AD -->
<div class="ad-inline">
<script async data-cfasync="false"
src="https://pl28637177.effectivegatecpm.com/fad14f1164a018aa8db8e8eb354764ac/invoke.js">
</script>
</div>

<script type="module">
import { db } from "./firebase.js";
import { doc,getDoc,updateDoc,increment }
from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const box = document.getElementById("newsBox");
const params = new URLSearchParams(window.location.search);
const newsId = params.get("id");

if(!newsId){
  box.innerHTML = "❌ News not found";
}else{
  const ref = doc(db,"news",newsId);

  // ✅ Auto views increase (1 per session)
  const viewKey = "viewed_" + newsId;
  if(!sessionStorage.getItem(viewKey)){
    updateDoc(ref,{ views: increment(1) });
    sessionStorage.setItem(viewKey,"1");
  }

  const snap = await getDoc(ref);
  if(!snap.exists()){
    box.innerHTML = "❌ News not found";
  }else{
    const d = snap.data();

    // ✅ SEO + SOCIAL SHARE SETUP (NEW)
    document.title = d.title + " | हिंदी न्यूज़";

    document.querySelector('meta[property="og:title"]').setAttribute(
      "content", d.title
    );
    document.querySelector('meta[property="og:description"]').setAttribute(
      "content", d.content.substring(0,120)
    );
    document.querySelector('meta[property="og:image"]').setAttribute(
      "content",
      d.image || "https://chhablala7-arch.github.io/my-news-website/default.jpg"
    );
    document.querySelector('meta[property="og:url"]').setAttribute(
      "content", window.location.href
    );

    box.innerHTML = `
      <h1>${d.title}</h1>
      ${d.image ? `<img src="${d.image}">` : ""}
      <div class="meta">Views: ${d.views ?? 0}</div>
      <div class="content">${d.content}</div>
    `;
  }
}
</script>

</body>
</html>
